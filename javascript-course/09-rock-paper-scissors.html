<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>09-rock-paper-scissors</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
        <link rel="stylesheet" href="my_habit.css" />

        <!-- <link rel="stylesheet" href="style.css"> -->
        <style>
            body,
            p,
            button {
                margin: 10px 5px 10px 5px;
            }
        </style>
    </head>
    <body>
        <p>Rock Paper Scissors</p>
        <button onclick="game(0)">Rock</button>
        <button onclick="game(1)">Paper</button>
        <button onclick="game(2)">Scissors</button>
        <p class="js-show-result">No result</p>
        <!-- <p>You paper - rock Computer</p> -->
        <p class="js-score"></p>
        <button onclick="reset()">Reset Score</button>
        <script>
            let user_choose = 0;
            let computer_choose = 0;
            let curr_result = "NO result";

            const score = JSON.parse(localStorage.getItem("score")) ?? {
                wins: 0,
                losses: 0,
                ties: 0,
            };

            document.querySelector(".js-score").innerHTML = `Wins: ${score.wins}, Losses: ${score.losses}, Ties: ${score.ties}`;
            function computetGet() {
                const a = Math.random();
                // console.log(a);
                if (a <= 1 / 3) {
                    return 0;
                } else if (a <= 2 / 3) {
                    return 1;
                } else {
                    return 2;
                }
            }

            // rock:0 paper:1 scissors:2
            function game(user_c) {
                user_choose = user_c;
                computer_choose = computetGet();
                console.log("-----------------");
                console.log(`user: ${user_choose} | computer: ${computer_choose}`);

                if (user_choose === computer_choose) {
                    // tie
                    score.ties++;
                    curr_result = "Tie";
                    console.log("tie");
                } else {
                    if ((user_choose - computer_choose + 3) % 3 === 1) {
                        // user win
                        score.wins++;
                        curr_result = "User win";
                        console.log("user win");
                    } else {
                        // computer win
                        score.losses++;
                        curr_result = "Computer win";
                        console.log("computer win");
                    }
                }
                document.querySelector(".js-show-result").innerHTML = `${curr_result}`;
                document.querySelector(".js-score").innerHTML = `Wins: ${score.wins}, Losses: ${score.losses}, Ties: ${score.ties}`;
                console.log(`Wins: ${score.wins}, Losses: ${score.losses}, Ties: ${score.ties}`);
                // save date in local
                localStorage.setItem("score", JSON.stringify(score));
                return;
            }
            function reset() {
                score.wins = 0;
                score.losses = 0;
                score.ties = 0;
                document.querySelector(".js-score").innerHTML = `Wins: ${score.wins}, Losses: ${score.losses}, Ties: ${score.ties}`;
                localStorage.setItem("score", JSON.stringify(score));
            }
        </script>
    </body>
</html>
